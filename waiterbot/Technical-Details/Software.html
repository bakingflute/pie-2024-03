<!DOCTYPE html>
<html style="font-size: 16px;" lang="en"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="INTUITIVE">
    <meta name="description" content="">
    <title>Software</title>
    <link rel="stylesheet" href="../nicepage.css" media="screen">
<link rel="stylesheet" href="Software.css" media="screen">
    <script class="u-script" type="text/javascript" src="../jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="../nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 7.1.0, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    <link id="u-page-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "../images/WaiterbotLogo.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Software">
    <meta property="og:type" content="website">
  <meta data-intl-tel-input-cdn-path="intlTelInput/"></head>
  <body data-path-to-root="../" data-include-products="false" class="u-body u-xl-mode" data-lang="en"><header class="u-clearfix u-custom-color-1 u-header u-sticky u-sticky-e914 u-header" id="sec-4c80"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="../" class="u-image u-logo u-image-1" title="Home" data-image-width="318" data-image-height="368">
          <img src="../images/WaiterbotLogo.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse u-custom-font u-font-lato" style="font-size: 1.5625rem; letter-spacing: 0px; font-weight: 900;">
            <a class="u-button-style u-custom-color u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-hover-color u-custom-text-shadow u-custom-top-bottom-menu-spacing u-hamburger-link u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg class="u-svg-link" viewBox="0 0 24 24"><use xlink:href="#menu-hamburger"></use></svg>
              <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</g></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-custom-font u-font-lato u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-hover-grey-25" href="../System.html" style="padding: 10px 20px;">System</a><div class="u-nav-popup"><ul class="u-custom-font u-font-lato u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-2"><li class="u-nav-item"><a class="u-button-style u-grey-30 u-hover-grey-30 u-nav-link u-text-body-alt-color" href="Mechanical.html">Mechanical</a>
</li><li class="u-nav-item"><a class="u-button-style u-grey-30 u-hover-grey-30 u-nav-link u-text-body-alt-color" href="Software.html">Software</a>
</li><li class="u-nav-item"><a class="u-button-style u-grey-30 u-hover-grey-30 u-nav-link u-text-body-alt-color" href="Firmware.html">Firmware</a>
</li><li class="u-nav-item"><a class="u-button-style u-grey-30 u-hover-grey-30 u-nav-link u-text-body-alt-color" href="Electrical.html">Electrical</a>
</li></ul>
</div>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-hover-grey-25" href="../Project-Timeline.html" style="padding: 10px 20px;">Project Timeline</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-hover-grey-25" href="../Team.html" style="padding: 10px 20px;">Team</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-hover-grey-25" href="https://docs.google.com/spreadsheets/d/1giVWhQ9K4Xasjjo8eRnHsvqwnmpMrquXVSKmliRF5nY/edit?usp=sharing" target="_blank" style="padding: 10px 20px;">Bill of Materials</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-3"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../System.html">System</a><div class="u-nav-popup"><ul class="u-custom-font u-font-lato u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-4"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Mechanical.html">Mechanical</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Software.html">Software</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Firmware.html">Firmware</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Electrical.html">Electrical</a>
</li></ul>
</div>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../Project-Timeline.html">Project Timeline</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../Team.html">Team</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="https://docs.google.com/spreadsheets/d/1giVWhQ9K4Xasjjo8eRnHsvqwnmpMrquXVSKmliRF5nY/edit?usp=sharing" target="_blank">Bill of Materials</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-white u-section-1" id="sec-29f1">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-default u-text-1">Software Overview</p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-2" id="sec-1737">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1">Walter's software system runs entirely using ROS2, a robotics middleware tool that allows us to abstract our robot’s software into a network of independent tasks called “nodes”. We created the following system diagram to explain how Walter’s ROS2 nodes pass information, perform calculations, and then act upon the world autonomously:<br>
        </p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-3" id="carousel_9ad6">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/image.png" data-image-width="2060" data-image-height="1054">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-4" id="carousel_f9c7">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1"> The robot’s software has three main system components: state estimation and localization, path planning and execution, and module control. Critical information such as its current position in the world, or its current destination, are passed between the nodes and used to make decisions. This is a completely autonomous system in which the only human input comes from pressing buttons to request a “delivery” to a certain destination.<br>
        </p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-5" id="carousel_2f9d">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1">
          <span style="text-decoration: underline !important;">State Estimation and Localization:</span>
          <span style="font-weight: 600;">
            <br>
            <span style="font-size: 1.5625rem;"></span>
          </span>
          <span style="font-size: 1.5rem;">
            <span style="font-weight: 400;">For this project, we want Walter to be able to localize where he is in the world frame regardless of where he is. The approach that we chose was to use computer vision to detect apriltags, and through frame transformations, return a pose estimate of where Walter is within the world.	Our first step is to calibrate our camera. To do this, we will need the following things: a camera ROS node that publishes images, a camera calibration ROS node, and a 7x9 white calibration <a href="https://www.mrpt.org/downloads/camera-calibration-checker-board_9x7.pdf" class="u-active-none u-border-none u-btn u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1">paper</a>.<span style="font-weight: 600;">&nbsp;</span>
            </span>
          </span>
          <br>
        </p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-6" id="carousel_7418">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/image1.png" data-image-width="1600" data-image-height="900">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-7" id="carousel_4be8">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1"> Once we are done, we save the calibration file in ~/.ros/camera_info/[camera_name].yaml so that it could be accessed by the camera node in the future.&nbsp;<br>Once this is complete, we set up the <a href="https://github.com/christianrauch/apriltag_ros" class="u-active-none u-border-none u-btn u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1">Apriltag ROS node</a> developed by Christian Rauch. Fortunately for us, the Apriltag ROS node publishes transformations to the /tf topic. In this topic, we will get information about where the apriltag is with regards to the camera frame. We simply take the inverse of the transformation provided TR, where R is the rotation matrix and T is the translation matrix. This will result in the matrix R-1T-1. Finally, we apply the transformation between the world frame and the Apriltag to give us our final result. We publish the result as a Pose object.<br>
        </p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-8" id="carousel_aad2">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/pose_estimate.png" data-image-width="960" data-image-height="540">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-9" id="carousel_617d">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1">Path Planning and Execution:<br>
          <span style="font-weight: 400; font-size: 1.5rem;"></span>
          <span style="font-size: 1.5rem; font-weight: 400;">Walter’s path planning system includes a map maker, a path planner, and a motion execution node, which work together to ensure Walter efficiently gets to where he needs to go. The map maker manages his reference map of the world, including AprilTag landmarks and table coordinates, using the ROS2 TransformManager tool. When a person presses a button to indicate where Walter should go next, the motion execution node uses this reference map along with a recent estimate of Walter’s location to figure out the velocities necessary to get him there quickly. This diagram showcases how Walter prioritizes correcting angular error over linear error to get to his destination:</span>
          <br>
        </p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-10" id="carousel_b09b">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/Screenshot2024-12-19at10.37.39PM.png" data-image-width="1958" data-image-height="1100">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-11" id="carousel_9be7">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1"> If Walter receives multiple destination requests, the path planner files them into a queue and only allows the most recent request to be visible to the rest of the system – this avoids routing interruptions and keeps Walter’s path stable. The path planner can be configured to either send Walter from one destination to the next, or to require him to return to the kitchen each time he completes a delivery. The two modes are visualized below:</p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-12" id="carousel_831a">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/pathplan1.png" data-image-width="960" data-image-height="540">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-13" id="carousel_9ee6">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/pathplan2.png" data-image-width="960" data-image-height="540">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-14" id="carousel_2ba2">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1">
          <span style="font-weight: 600; font-size: 1.875rem; text-decoration: underline !important;">Module Control and Serial Data:</span>
          <br>
          <span style="font-size: 1.5rem;"></span>
          <span style="font-size: 1.5rem;">The module control node is in charge of controlling when to extend and retract the four-bar module. When Walter reaches a new destination, module control node actuates the four-bar to offer food. When someone removes weight from the four-bar, the strain gauges underneath communicate this to the model control node and it commands the four-bar to retract. When the four-bar is completely retracted, the node will indicate to the path planner that Walter is ready to pilot to his next goal.<br>An important aspect of this control is its ability to track its status. We split the system into four following statuses.<br>0. Walter hasn’t reached its destination
          </span>
          <span style="font-weight: 400;">
            <br>
            <span style="font-size: 1.5rem;">1. Extend the arm</span>
            <br>
            <span style="font-size: 1.5rem;">2. Retract the arm</span>
            <br>
            <span style="font-size: 1.5rem;">3</span>
            <span style="font-size: 1.5rem;">. Waiting for next goal location<br>By doing this, we can specifically tell Walter that it shouldn’t move when the four-bar module status is at 1 and 2. Furthermore, we can publicly publish to all other nodes so that other nodes will know to set the next location when the four-bar module status is at 3.
            </span>
          </span>
          <br>
        </p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-15" id="sec-f8cf">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/fourbar.png" data-image-width="960" data-image-height="540">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-16" id="carousel_ad74">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1"> To communicate with our Arduinos, we created a serial ROS node that either parses data coming from the read port or strain gauge port and sends data to the write port. The table below shows the codes we used to make sure our firmware and software are properly integrated.</p>
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-17" id="carousel_71ae">
      <div class="u-clearfix u-sheet u-sheet-1">
        <img class="custom-expanded u-align-center u-image u-image-1" src="../images/Screenshot2024-12-19at10.39.33PM.png" data-image-width="1132" data-image-height="870">
      </div>
    </section>
    <section class="u-align-center u-clearfix u-container-align-center u-section-18" id="carousel_0758">
      <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
        <p class="u-align-left u-custom-font u-font-lato u-text u-text-1">
          <span style="font-size: 30px;"><u></u>
          </span>External software dependencies:<br>
          <span style="font-size: 1.5rem;">
            <span style="font-style: italic;">Pip requirements:</span>
            <br>ament_copyright==0.12.11<br>ament_flake8==0.12.11<br>ament_index_python==1.4.0<br>ament_pep257==0.12.11<br>apriltag_msgs==2.0.1<br>geometry_msgs==4.2.4<br>launch_ros==0.19.7<br>numpy==1.21.5<br>opencv_contrib_python==4.10.0.84<br>opencv_python==4.10.0.84<br>opencv_python_headless==4.8.1.78<br>pyserial==3.5<br>pytest==6.2.5<br>rclpy==3.3.14<br>setuptools==59.6.0<br>std_msgs==4.2.4<br>tf2_msgs==0.25.8<br>tf2_ros_py==0.25.8<br>tf_transformations==1.1.0
          </span>
          <br>
          <br>
          <span style="font-size: 1.5rem;">
            <span style="font-style: italic;">External ROS nodes</span>
            <br>v4l2: <a href="https://github.com/tier4/ros2_v4l2_camera" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1">https://github.com/tier4/ros2_v4l2_camera</a>&nbsp;<br>apriltag_ros: <a href="https://github.com/christianrauch/apriltag_ros" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-2">https://github.com/christianrauch/apriltag_ros</a>&nbsp;<br>camera_calibration: <a href="https://github.com/ros-perception/image_pipeline" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-3">https://github.com/ros-perception/image_pipeline</a>&nbsp;<br>
            <br>
            <span style="font-style: italic;">Github</span>
          </span>
          <br>
          <span style="font-size: 1.5rem;">
            <a href="https://github.com/itannermahncke/pie_waiterbot" class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-4">https://github.com/itannermahncke/pie_waiterbot</a>
          </span>
          <br>
        </p>
      </div>
    </section>
    
    
    
    <footer class="u-align-center u-clearfix u-container-align-center u-footer u-grey-80 u-footer" id="sec-a059"><div class="u-clearfix u-sheet u-sheet-1"></div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <p class="u-text">
        <span>This site was created with the </span>
        <a class="u-link" href="https://nicepage.com/" target="_blank" rel="nofollow">
          <span>Nicepage</span>
        </a>
      </p>
    </section>
  
</body></html>